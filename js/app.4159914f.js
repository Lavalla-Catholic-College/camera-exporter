(function(){"use strict";var e={142:function(e,o,t){var a=t(5130),r=t(6768),n=t(4232);const s={class:"container"},i={key:0,class:"row"},l={class:"col"},u={class:"form-group"},c={class:"form-group"},m={class:"form-group"},d={class:"mt-3"},f={key:1},h={class:"row"},p={class:"col-6"},v={class:"form-group"},k=["value"],b={class:"col-6"},w={class:"form-group"},g=["src"],L={class:"row mt-4"},y={class:"col-6"},C={class:"form-group"},D=["max"],j={class:"form-group mt-4"},x={class:"col-6"},T={class:"form-group"},O={class:"form-control"},_=["onClick"],Y={class:"row mt-4"},E={class:"col"},M=["href","download"];function U(e,o,t,U,H,P){return(0,r.uX)(),(0,r.CE)("div",s,[o[15]||(o[15]=(0,r.Lk)("h1",null,"Camera Footage Exporter",-1)),H.token?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",i,[(0,r.Lk)("div",l,[(0,r.Lk)("div",u,[o[7]||(o[7]=(0,r.Lk)("label",{for:"username",class:"form-label"},"NVR",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"nvr",name:"nvr","onUpdate:modelValue":o[0]||(o[0]=e=>H.nvr=e)},null,512),[[a.Jo,H.nvr]])]),(0,r.Lk)("div",c,[o[8]||(o[8]=(0,r.Lk)("label",{for:"username",class:"form-label"},"Username",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"username",name:"username","onUpdate:modelValue":o[1]||(o[1]=e=>H.username=e)},null,512),[[a.Jo,H.username]])]),(0,r.Lk)("div",m,[o[9]||(o[9]=(0,r.Lk)("label",{for:"password",class:"form-label"},"Password",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"password",name:"password","onUpdate:modelValue":o[2]||(o[2]=e=>H.password=e)},null,512),[[a.Jo,H.password]])]),(0,r.Lk)("div",d,[(0,r.Lk)("button",{class:"btn btn-primary",onClick:o[3]||(o[3]=e=>P.login())},"Login")])])])),H.token?((0,r.uX)(),(0,r.CE)("div",f,[(0,r.Lk)("div",h,[(0,r.Lk)("div",p,[(0,r.Lk)("div",v,[o[10]||(o[10]=(0,r.Lk)("label",{for:"cameras",class:"form-label"},"Camera",-1)),(0,r.bo)((0,r.Lk)("select",{class:"form-control",name:"camera",id:"camera","onUpdate:modelValue":o[4]||(o[4]=e=>H.selectedCamera=e),size:"10"},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(H.cameras,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,n.v_)(e.name),9,k)))),128))],512),[[a.u1,H.selectedCamera]])])]),(0,r.Lk)("div",b,[(0,r.Lk)("div",w,[o[11]||(o[11]=(0,r.Lk)("label",{for:"thumbnail",class:"form-label"},"Thumbnail",-1)),(0,r.Lk)("img",{class:"img-fluid img-thumbnail camera-thumbnail",src:P.cameraThumbnail},null,8,g)])])]),(0,r.Lk)("div",L,[(0,r.Lk)("div",y,[(0,r.Lk)("div",C,[o[12]||(o[12]=(0,r.Lk)("label",{for:"footageDate",class:"form-label"},"Date",-1)),(0,r.bo)((0,r.Lk)("input",{class:"form-control",type:"datetime-local","onUpdate:modelValue":o[5]||(o[5]=e=>H.footageDate=e),max:P.footageDateMaxTime},null,8,D),[[a.Jo,H.footageDate]]),(0,r.Lk)("small",null,"Date is "+(0,n.v_)(P.footageDateAsHumanReadable),1)]),(0,r.Lk)("div",j,[o[13]||(o[13]=(0,r.Lk)("label",{for:"duration",class:"form-label"},"Duration (in minutes)",-1)),(0,r.bo)((0,r.Lk)("input",{class:"form-control",type:"number",min:"1","onUpdate:modelValue":o[6]||(o[6]=e=>H.duration=e)},null,512),[[a.Jo,H.duration]])])]),(0,r.Lk)("div",x,[(0,r.Lk)("div",T,[o[14]||(o[14]=(0,r.Lk)("label",{for:"footageDate",class:"form-label"},"Shortcuts",-1)),(0,r.Lk)("div",O,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(H.dateShortcuts,((e,o)=>((0,r.uX)(),(0,r.CE)("button",{onClick:e=>P.modifyDate(o),class:"btn btn-primary",key:e},(0,n.v_)(o),9,_)))),128))])])])]),(0,r.Lk)("div",Y,[(0,r.Lk)("div",E,[(0,r.Lk)("a",{class:"btn btn-primary",href:P.downloadURL,download:`${H.selectedCamera.name}.mkv`,target:"_blank"},"Download Footage",8,M)])])])):(0,r.Q3)("",!0)])}var H={name:"App",beforeMount(){window.dayjs.extend(window.dayjs_plugin_objectSupport),window.dayjs.extend(window.dayjs_plugin_relativeTime)},data(){return{nvr:"10.12.10.100:7001",username:"admin",password:"",token:null,cameras:[],selectedCamera:[],thumbnail:"",loggedIn:!1,duration:60,footageDate:(new window.dayjs).subtract(1,"hour").format("YYYY-MM-DDTHH:mm:ss.000"),dateShortcuts:{"Before School":{time:{hour:8,minute:0},duration:60},Homeroom:{time:{hour:9,minute:0},duration:30},"Period 1":{time:{hour:9,minute:15},duration:60},"Period 2":{time:{hour:10,minute:10},duration:60},Recess:{time:{hour:11,minute:10},duration:40},"Period 3":{time:{hour:11,minute:30},duration:70},"Period 4":{time:{hour:12,minute:30},duration:70},Lunch:{time:{hour:13,minute:25},duration:60},"Period 5":{time:{hour:14,minute:10},duration:70},"After School":{time:{hour:15,minute:10},duration:60}}}},computed:{cameraThumbnail(){return"https://"+this.nvr+"/rest/v2/devices/"+this.selectedCamera?.id+"/image?size=320x240"},footageDateFinal(){return this.footageDate},downloadURL(){return`https://${this.nvr}/hls/${this.selectedCamera.id}.mkv?pos=${this.footageDate}&duration=${60*this.duration}`},footageDateAsHumanReadable(){return new window.dayjs(this.footageDate).fromNow()},footageDateMaxTime(){return(new window.dayjs).format("YYYY-MM-DDTHH:mm:ss.000")}},methods:{modifyDate(e){const o=this.dateShortcuts[e];this.duration=o["duration"],this.footageDate=new window.dayjs(o["time"]).format("YYYY-MM-DDTHH:mm:ss.000")},async login(){try{const e=await fetch("https://"+this.nvr+"/rest/v2/login/sessions",{method:"POST",body:JSON.stringify({username:this.username,password:this.password,setCookie:!0}),mode:"cors",headers:{"Content-Type":"application/json"}}),o=await e.json();o?.["token"]?(this.token=o["token"],this.getCameras()):(alert("Unable to log in. Is your username and password correct?"),this.token=null)}catch(e){alert("Error logging in. Check the web console for more information"),console.error(e),this.token=null}},async getCameras(){if(!this.token)return!1;try{const e=await fetch("https://"+this.nvr+"/rest/v2/devices?_orderBy=name&deviceType=Camera",{mode:"cors",credentials:"include"}),o=await e.json();this.cameras=o}catch(e){console.error(e)}}}},P=t(1241);const S=(0,P.A)(H,[["render",U]]);var V=S;(0,a.Ef)(V).mount("#app")}},o={};function t(a){var r=o[a];if(void 0!==r)return r.exports;var n=o[a]={exports:{}};return e[a].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(o,a,r,n){if(!a){var s=1/0;for(c=0;c<e.length;c++){a=e[c][0],r=e[c][1],n=e[c][2];for(var i=!0,l=0;l<a.length;l++)(!1&n||s>=n)&&Object.keys(t.O).every((function(e){return t.O[e](a[l])}))?a.splice(l--,1):(i=!1,n<s&&(s=n));if(i){e.splice(c--,1);var u=r();void 0!==u&&(o=u)}}return o}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,r,n]}}(),function(){t.n=function(e){var o=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(o,{a:o}),o}}(),function(){t.d=function(e,o){for(var a in o)t.o(o,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:o[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){var e={524:0};t.O.j=function(o){return 0===e[o]};var o=function(o,a){var r,n,s=a[0],i=a[1],l=a[2],u=0;if(s.some((function(o){return 0!==e[o]}))){for(r in i)t.o(i,r)&&(t.m[r]=i[r]);if(l)var c=l(t)}for(o&&o(a);u<s.length;u++)n=s[u],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(c)},a=self["webpackChunkcamera_exporter"]=self["webpackChunkcamera_exporter"]||[];a.forEach(o.bind(null,0)),a.push=o.bind(null,a.push.bind(a))}();var a=t.O(void 0,[504],(function(){return t(142)}));a=t.O(a)})();
//# sourceMappingURL=app.4159914f.js.map